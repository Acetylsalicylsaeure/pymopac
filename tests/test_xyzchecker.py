import pytest
from pymopac.helpers import xyz_identifier


def test_correct():
    string = """C          0.90518       -0.00675        0.01399
C          2.41725       -0.00675        0.01399
H          0.52091       -0.46058       -0.90436
H          0.52091        1.01548        0.08014
H          0.52090       -0.57515        0.86619
H          2.80152        0.56165       -0.83821
H          2.80152       -1.02898       -0.05216
H          2.80152        0.44708        0.93234"""
    state, geo = xyz_identifier(string)
    assert state is True and geo == "\n"+string+"\n"


def test_correct_withNumber():
    string = """14

C          1.40256       -0.21961       -0.05405
C          0.51726       -1.29786        0.00101
C         -0.85979       -1.07066        0.02882
C         -1.35782        0.23300        0.00670
C         -0.47802        1.31417       -0.04837
C          0.90033        1.08478       -0.08262
C          1.83951        2.22170       -0.15650
O          1.45691        3.38457       -0.19777
H          2.47222       -0.40938       -0.07670
H          0.89826       -2.31580        0.01987
H         -1.54854       -1.91187        0.06686
H         -2.43093        0.40747        0.03077
H         -0.86662        2.33026       -0.06670
H          2.91354        1.97213       -0.17702
"""
    state, geo = xyz_identifier(string)
    assert state is True and geo == string[3:]


def test_correct_plusWhitespace():
    string = """14

     
C          1.40256       -0.21961       -0.05405
C          0.51726       -1.29786        0.00101
C         -0.85979       -1.07066        0.02882
C         -1.35782        0.23300        0.00670
C         -0.47802        1.31417       -0.04837
C          0.90033        1.08478       -0.08262
C          1.83951        2.22170       -0.15650
O          1.45691        3.38457       -0.19777
H          2.47222       -0.40938       -0.07670
H          0.89826       -2.31580        0.01987
H         -1.54854       -1.91187        0.06686
H         -2.43093        0.40747        0.03077
H         -0.86662        2.33026       -0.06670
H          2.91354        1.97213       -0.17702


   """
    target = """
C          1.40256       -0.21961       -0.05405
C          0.51726       -1.29786        0.00101
C         -0.85979       -1.07066        0.02882
C         -1.35782        0.23300        0.00670
C         -0.47802        1.31417       -0.04837
C          0.90033        1.08478       -0.08262
C          1.83951        2.22170       -0.15650
O          1.45691        3.38457       -0.19777
H          2.47222       -0.40938       -0.07670
H          0.89826       -2.31580        0.01987
H         -1.54854       -1.91187        0.06686
H         -2.43093        0.40747        0.03077
H         -0.86662        2.33026       -0.06670
H          2.91354        1.97213       -0.17702
"""
    state, geo = xyz_identifier(string)
    assert state is True and geo == target
